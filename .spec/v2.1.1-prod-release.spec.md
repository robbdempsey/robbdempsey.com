# Production Release Plan

## Overview
Implement a production release workflow that creates a semantic versioned release and deploys the website to the production S3 bucket when code is merged into the main branch.

## Current Setup Analysis
- **Version**: 2.1.0 (from package.json) - target version after implementation: 2.1.1
- **Dev Workflow**: `deploy-dev.yml` handles build, lint, and deployment to dev S3 on push to main or manual dispatch.
- **Build Output**: Static files in `out/` directory.
- **Deployment**: Uses AWS S3 sync, with OIDC for credentials.

## Requirements
- Do not modify the existing dev workflow.
- Add a new GitHub workflow for production releases.
- Trigger on merge to main (push to main).
- Create a GitHub release with semantic versioning.
- Deploy to production S3 bucket.
- Use production environment variables (similar to dev but for prod).

## Plan Steps
1. **Semantic Versioning Strategy**:
   - Use conventional commits to determine version bumps (e.g., feat: for minor, fix: for patch).
   - Implement semantic-release or a similar tool to automate versioning and release creation.
   - Update package.json version to 2.1.1 and create GitHub release tagged as v2.1.1.

2. **New Workflow File**: Create `.github/workflows/deploy-prod.yml`
   - Trigger: push to main (after merge).
   - Jobs:
     - Build: Similar to dev (checkout, setup node, install, lint, build).
     - Release: Use semantic-release to create GitHub release and update version.
     - Deploy: Deploy to prod S3, using prod environment and secrets.

3. **Security and Permissions**:
   - Use OIDC for AWS credentials.
   - Set appropriate permissions (contents: read, id-token: write).
   - Ensure least privilege.

4. **Testing and Validation**:
   - Add health check after deployment.
   - Optionally, add CloudFront invalidation.

5. **Rollback Strategy**: Document manual rollback process (e.g., redeploy previous release).

## Implementation Checklist
- [x] Install and configure semantic-release (add to devDependencies if needed).
- [x] Create deploy-prod.yml workflow.
- [ ] Test workflow on a feature branch or staging.
- [ ] Merge and verify production deployment.

## Risks and Mitigations
- Version conflicts: Ensure semantic-release is configured correctly.
- Deployment failures: Implement health checks and manual rollback.
- Secrets exposure: Use GitHub secrets and OIDC.

## Next Steps
Review this plan and approve implementation.